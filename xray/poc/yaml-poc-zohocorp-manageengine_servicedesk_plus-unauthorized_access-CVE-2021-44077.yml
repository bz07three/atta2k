name: yaml-poc-zohocorp-manageengine_servicedesk_plus-unauthorized_access-CVE-2021-44077
binding: 46e3263c-91c5-44ba-8824-b1820ab70a13
detail:
    author: jiapeng.han
    links:
        - http://packetstormsecurity.com/files/165400/ManageEngine-ServiceDesk-Plus-Remote-Code-Execution.html
        - https://cxsecurity.com/issue/WLB-2021120112
        - https://nvd.nist.gov/vuln/detail/CVE-2021-44077
        - https://packetstormsecurity.com/files/165400/ManageEngine-ServiceDesk-Plus-Remote-Code-Execution.html
        - https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-authentication-bypass-vulnerability-in-servicedesk-plus-versions-11138-and-above
        - https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-servicedesk-plus-msp-versions-10527-till-10529
        - https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-servicedesk-plus-versions-up-to-11305-22-11-2021
        - https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-supportcenter-plus-versions-11012-and-11013
        - https://www.cybersecurity-help.cz/vdb/SB2021120304
    vulnerability:
        id: fa2f4293-6b9f-431d-bb8f-a665744c7672
        level: critical
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /RestAPI/ImportTechnicians
            follow_redirects: false
        expression: response.status == 200 && response.body_string.contains("<form name=\"ImportTechnicians\"") && response.body_string.contains("action=\"/ImportTechnicians.do\"")
expression: r0()
